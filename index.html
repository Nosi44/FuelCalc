<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>–†–∞—Å—Ö–æ–¥ —Ç–æ–ø–ª–∏–≤–∞</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f2f2f2;
    padding:10px;
}
.month{
    background:#fff;
    padding:8px;
    margin-bottom:8px;
    border-radius:8px;
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    gap:4px;
}
.month b{ width:90px; }
input,select{
    padding:4px;
    font-size:14px;
}
.result{
    font-weight:bold;
    margin-left:6px;
}
.total{
    font-size:20px;
    font-weight:bold;
    margin-top:12px;
}
.buttons{ margin-top:10px; }
.converter{
    margin-top:25px;
    background:#fff;
    padding:12px;
    border-radius:8px;
}
.converter input{
    width:100%;
    padding:6px;
    font-size:16px;
}
#wordsResult{
    margin-top:10px;
    font-weight:bold;
}
</style>
</head>

<body>

<h2>–†–∞—Å—Ö–æ–¥ —Ç–æ–ø–ª–∏–≤–∞</h2>

<div id="months"></div>

<div class="total" id="total">–°—É–º–º–∞: 0.00 —Å–∫–ª.–º.</div>

<div class="buttons">
<button onclick="save()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
<button onclick="load()">üìÇ –ó–∞–≥—Ä—É–∑–∏—Ç—å</button>
</div>

<div class="converter">
<input type="number" id="numberInput"
       placeholder="–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ (–¥–æ 99 999 999)"
       oninput="convertNumber()">
<div id="wordsResult"></div>
</div>

<script>

// ====== –ö–û–≠–§–§–ò–¶–ò–ï–ù–¢–´ ======
const temp_coef={
"+8":0.43,"+7":0.47,"+6":0.51,"+5":0.555,"+4":0.60,"+3":0.645,
"+2":0.69,"+1":0.73,"0":0.77,"-1":0.815,"-2":0.86,"-3":0.90,
"-4":0.94,"-5":0.995,"-6":1.03,"-7":1.07,"-8":1.11,"-9":1.155,
"-10":1.20,"-11":1.245,"-12":1.29,"-13":1.33,"-14":1.37,
"-15":1.415,"-16":1.46,"-17":1.50,"-18":1.54,"-19":1.585,
"-20":1.63,"-21":1.67,"-22":1.71,"-23":1.755,"-24":1.80,
"-25":1.845,"-26":1.89,"-27":1.93,"-28":1.97,"-29":2.015,"-30":2.06
};

const wood_coef={
"–°–º–µ—à–∞–Ω—ã–µ":0.186,"–ö–ª–µ–Ω":0.262,"–ì—Ä–∞–±":0.290,"–Ø—Å–µ–Ω—å":0.274,
"–î—É–±":0.285,"–ë—É–∫":0.253,"–ë–µ—Ä–µ–∑–∞":0.230,"–í—è–∑":0.250,
"–°–æ—Å–Ω–∞":0.208,"–û–ª—å—Ö–∞":0.193,"–ï–ª—å":0.178,"–û—Å–∏–∫–∞":0.183,
"–õ–∏–ø–∞":0.179,"–ü–∏—Ö—Ç–∞":0.175,"–¢–æ–ø–æ–ª—å":0.146
};

const months=["–û–∫—Ç—è–±—Ä—å","–ù–æ—è–±—Ä—å","–î–µ–∫–∞–±—Ä—å","–Ø–Ω–≤–∞—Ä—å","–§–µ–≤—Ä–∞–ª—å","–ú–∞—Ä—Ç"];
const rows=[];

// ====== –°–û–ó–î–ê–ù–ò–ï –°–¢–†–û–ö ======
function createRow(name){
    const div=document.createElement("div");
    div.className="month";

    const temp=select(temp_coef);
    const area=input("25");
    const days=input("30");
    const burj=input("0.44");
    const wood=select(wood_coef);
    const last=input("1000");
    const check=document.createElement("input");
    check.type="checkbox"; check.checked=true;
    const result=document.createElement("span");
    result.className="result";

    [temp,area,days,burj,wood,last,check].forEach(e=>e.oninput=calc);

    div.innerHTML=`<b>${name}</b>`;
    div.append(temp," √ó ",area," √ó ",days," / ",
               burj," / ",wood," / ",last," = ",
               result," ",check);

    rows.push({temp,area,days,burj,wood,last,check,result});
    document.getElementById("months").append(div);
}

function input(v){
    const i=document.createElement("input");
    i.value=v; i.size=5;
    return i;
}
function select(obj){
    const s=document.createElement("select");
    for(let k in obj){
        const o=document.createElement("option");
        o.value=o.textContent=k;
        s.append(o);
    }
    return s;
}

// ====== –†–ê–°–ß–Å–¢ ======
function calc(){
    let total=0;
    rows.forEach(r=>{
        try{
            const v=temp_coef[r.temp.value]*+r.area.value*+r.days.value/
                    +r.burj.value/wood_coef[r.wood.value]/+r.last.value;
            r.result.textContent=v.toFixed(2);
            if(r.check.checked) total+=v;
        }catch{ r.result.textContent="‚Ä¶"; }
    });
    document.getElementById("total").textContent=
        `–°—É–º–º–∞: ${total.toFixed(2)} —Å–∫–ª.–º.`;
}

// ====== LOCAL STORAGE ======
function save(){
    localStorage.setItem("heating",
        JSON.stringify(rows.map(r=>({
            temp:r.temp.value,area:r.area.value,days:r.days.value,
            burj:r.burj.value,wood:r.wood.value,last:r.last.value,
            check:r.check.checked
        })))
    );
}
function load(){
    const d=JSON.parse(localStorage.getItem("heating")||"[]");
    d.forEach((s,i)=>{
        if(rows[i]){
            rows[i].temp.value=s.temp;
            rows[i].area.value=s.area;
            rows[i].days.value=s.days;
            rows[i].burj.value=s.burj;
            rows[i].wood.value=s.wood;
            rows[i].last.value=s.last;
            rows[i].check.checked=s.check;
        }
    });
    calc();
}

// ====== –ö–û–ù–í–ï–†–¢–ï–† –î–û 100 –ú–õ–ù ======
function convertNumber(){
    let n=parseInt(document.getElementById("numberInput").value);
    if(isNaN(n)||n<0||n>99999999){
        document.getElementById("wordsResult").textContent="";
        return;
    }
    if(n===0){
        document.getElementById("wordsResult").textContent="–Ω—É–ª—å";
        return;
    }

    const onesM=["","–æ–¥–∏–Ω","–¥–≤–∞","—Ç—Ä–∏","—á–æ—Ç–∏—Ä–∏","–ø‚Äô—è—Ç—å","—à—ñ—Å—Ç—å","—Å—ñ–º","–≤—ñ—Å—ñ–º","–¥–µ–≤‚Äô—è—Ç—å"];
    const onesF=["","–æ–¥–Ω–∞","–¥–≤—ñ","—Ç—Ä–∏","—á–æ—Ç–∏—Ä–∏","–ø‚Äô—è—Ç—å","—à—ñ—Å—Ç—å","—Å—ñ–º","–≤—ñ—Å—ñ–º","–¥–µ–≤‚Äô—è—Ç—å"];
    const teens=["–¥–µ—Å—è—Ç—å","–æ–¥–∏–Ω–∞–¥—Ü—è—Ç—å","–¥–≤–∞–Ω–∞–¥—Ü—è—Ç—å","—Ç—Ä–∏–Ω–∞–¥—Ü—è—Ç—å","—á–æ—Ç–∏—Ä–Ω–∞–¥—Ü—è—Ç—å",
    "–ø‚Äô—è—Ç–Ω–∞–¥—Ü—è—Ç—å","—à—ñ—Å—Ç–Ω–∞–¥—Ü—è—Ç—å","—Å—ñ–º–Ω–∞–¥—Ü—è—Ç—å","–≤—ñ—Å—ñ–º–Ω–∞–¥—Ü—è—Ç—å","–¥–µ–≤‚Äô—è—Ç–Ω–∞–¥—Ü—è—Ç—å"];
    const tens=["","","–¥–≤–∞–¥—Ü—è—Ç—å","—Ç—Ä–∏–¥—Ü—è—Ç—å","—Å–æ—Ä–æ–∫","–ø‚Äô—è—Ç–¥–µ—Å—è—Ç",
    "—à—ñ—Å—Ç–¥–µ—Å—è—Ç","—Å—ñ–º–¥–µ—Å—è—Ç","–≤—ñ—Å—ñ–º–¥–µ—Å—è—Ç","–¥–µ–≤‚Äô—è–Ω–æ—Å—Ç–æ"];
    const hundreds=["","—Å—Ç–æ","–¥–≤—ñ—Å—Ç—ñ","—Ç—Ä–∏—Å—Ç–∞","—á–æ—Ç–∏—Ä–∏—Å—Ç–∞","–ø‚Äô—è—Ç—Å–æ—Ç",
    "—à—ñ—Å—Ç—Å–æ—Ç","—Å—ñ–º—Å–æ—Ç","–≤—ñ—Å—ñ–º—Å–æ—Ç","–¥–µ–≤‚Äô—è—Ç—Å–æ—Ç"];

    function chunk(num,female=false){
        let words="";
        let h=Math.floor(num/100);
        let t=num%100;
        if(h) words+=hundreds[h]+" ";
        if(t>=10&&t<20) words+=teens[t-10]+" ";
        else{
            let tt=Math.floor(t/10);
            let o=t%10;
            if(tt) words+=tens[tt]+" ";
            if(o) words+=(female?onesF[o]:onesM[o])+" ";
        }
        return words.trim();
    }

    function plural(n,f){
        n=Math.abs(n)%100;
        let n1=n%10;
        if(n>10&&n<20) return f[2];
        if(n1>1&&n1<5) return f[1];
        if(n1==1) return f[0];
        return f[2];
    }

    let result="";
    let millions=Math.floor(n/1000000);
    if(millions){
        result+=chunk(millions)+" "+
        plural(millions,["–º—ñ–ª—å–π–æ–Ω","–º—ñ–ª—å–π–æ–Ω–∏","–º—ñ–ª—å–π–æ–Ω—ñ–≤"])+" ";
        n%=1000000;
    }

    let thousands=Math.floor(n/1000);
    if(thousands){
        result+=chunk(thousands,true)+" "+
        plural(thousands,["—Ç–∏—Å—è—á–∞","—Ç–∏—Å—è—á—ñ","—Ç–∏—Å—è—á"])+" ";
        n%=1000;
    }

    if(n) result+=chunk(n);

    document.getElementById("wordsResult").textContent=result.trim();
}

// ====== –ó–ê–ü–£–°–ö ======
months.forEach(createRow);
calc();

</script>
</body>
</html>
